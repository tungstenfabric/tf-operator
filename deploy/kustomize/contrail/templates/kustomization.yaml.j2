{%- if CONTRAIL_CONTAINER_TAG is not defined or CONTRAIL_CONTAINER_TAG == "" -%}
{%- set CONTRAIL_CONTAINER_TAG = "latest" -%}
{%- endif -%}
{%- if CONTAINER_REGISTRY is not defined or CONTAINER_REGISTRY == "" -%}
{%- set CONTAINER_REGISTRY = "tungstenfabric" -%}
{%- endif -%}
bases:
- ../../base/contrail

# set replicas=1
patchesStrategicMerge:
  - replicas.yaml

# set contrail-status image
patchesJson6902:
  - target:
      kind: Manager
      name: cluster1
      group: contrail.juniper.net
      version: v1alpha1
    path: contrail-status.json

images:
# Public containers
# TODO: use tf mirrors
- name: python
  newTag: 3.8.2-alpine
  newName: python
- name: busybox
  newTag: latest
  newName: busybox
# Contrail externals
- name: cassandra
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-external-cassandra
- name: zookeeper
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-external-zookeeper
- name: rabbitmq
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-external-rabbitmq
- name: redis
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-external-redis
# Contrail
- name: contrail-analytics-api
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-analytics-api
- name: contrail-controller-config-api
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-controller-config-api
- name: contrail-analytics-collector
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-analytics-collector
- name: contrail-controller-config-devicemgr
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-controller-config-devicemgr
- name: contrail-controller-config-dnsmasq
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-controller-config-dnsmasq
- name: contrail-controller-config-schema
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-controller-config-schema
- name: contrail-controller-config-svcmonitor
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-controller-config-svcmonitor
- name: contrail-analytics-query-engine
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-analytics-query-engine
- name: contrail-controller-control-control
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-controller-control-control
- name: contrail-controller-control-dns
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-controller-control-dns
- name: contrail-controller-control-named
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-controller-control-named
- name: contrail-kubernetes-kube-manager
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-kubernetes-kube-manager
- name: contrail-node-init
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-node-init
- name: contrail-vrouter-agent
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-vrouter-agent
- name: contrail-kubernetes-cni-init
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-kubernetes-cni-init
- name: contrail-vrouter-kernel-build-init
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-vrouter-kernel-build-init
- name: contrail-vrouter-kernel-init
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-vrouter-kernel-init
- name: contrail-node-init
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-node-init
- name: contrail-vrouter-agent
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-vrouter-agent
- name: contrail-vrouter-kernel-build-init
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-vrouter-kernel-build-init
- name: contrail-vrouter-kernel-init
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-vrouter-kernel-init
- name: contrail-controller-webui-job
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-controller-webui-job
- name: contrail-controller-webui-web
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-controller-webui-web
- name: contrail-provisioner
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-provisioner
- name: contrail-nodemgr
  newTag: {{ CONTRAIL_CONTAINER_TAG }}
  newName: {{ CONTAINER_REGISTRY }}/contrail-nodemgr
